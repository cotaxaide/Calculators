<!DOCTYPE HTML>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta name="author" content="Jeff Bogart, CO1/D18 Longmont TC">
	<title>Home Sale Worksheet</title>

<style type="text/css">
	html { background-color: #ccdcec; }
	body { background-color: #ccdcec; font-family: sans-serif; min-width: 60em; width: 60em; margin: auto;}
	button { cursor: pointer; background-color: lightgreen; }
	table { border-collapse: collapse; }
	tr { vertical-align: top; }
	th { background-color: #c7c7c7; }
	select { width: 9em; font-size: 95%; }
	input { text-align: left; font-size: 100%; }
	input, select { background-color: white; }
	input[type="number"] { width: 9em; text-align: right; }
	input[type="radio"] { margin-left: 1em; cursor: pointer; }
	input[type="checkbox"] { cursor: pointer; }
	input:disabled, select:disabled {
		background-color: transparent;
		font-weight: bold;
		cursor: not-allowed;
	}
	.bold { font-weight: bold; }
	.italic { font-style: italic; }
	.center { text-align: center; }
	.tblHeader { font-size:110%; font-weight:bold; text-decoration:underline; }
	.title { font-size:125%; font-weight:bold; }
	.instruction { font-style: italic; float: right; }
	.comment { font-style: italic; }
	.section {
		background-color: #eeeefe;
		padding: 1em;
		border: 1px solid black;
		width: 98%;
		margin-top: 1em;
	}
	.tabs {
		width: 100%;
		margin-top: 5px;
		position: relative;
		top: 0;
	}
	.tab {
		background-color: #eeeefe;
		font-weight: bold;
		font-size: 120%;
		text-align: center;
		width: 23%; 
		margin-left: 1.4%;
		display: inline-block;
		border: 1px solid black;
		border-bottom: none;
		border-radius: 12px 12px 0 0;
		padding: 10px 0;
		position: relative;
		top: 0;
		cursor: pointer;
	}
	.hide {
		display: none;
	}
	#HomeDiv,
	#InfoDiv,
	#SaleDiv,
	#CostDiv {
		margin-top: 0;
	}
	#HomeMFSNotice {
		display: none;
	}
	#SaleMFSNotice,
	#CostMFSNotice {
		font-style: italic;
		width: 100%;
		text-align: center;
		display: none;
	}
	#DepName,
	.TPName { width: 20em; font-size: 100%; }
	.tblLayout {
		width: 100%;
	}
	.tblLayout tr td {
		border-bottom: 1px solid grey;
		vertical-align: middle;
	}
	.tblLayout tr td:first-child {
		width: 18em;
	}
	.tblLayout tr td:nth-child(2) {
		width: 10em;
		white-space: nowrap;
	}
	.indent {
		padding-left: 2em;
		width: 16em;
	}
	#TSInputDiv {
		display: none;
	}
	#TSTable {
		width: 100%;
	}
	#TSTable tr th { text-align: center; }
	#TSTable tr th:first-child { width: 2em; }
	#TSTable tr th:nth-child(2) { width: 2em; }
	#TSTable tr th:nth-child(4) { width: 6em; text-align: right;}
	#TSTable tr td { border-bottom: 1px solid grey; }
	#ClearAndPrint { text-align: center; float:right; z-level:2; position: absolute; top: 0.8em; right: 1em; }
	#QualificationMessage {
		width: 100%;
		font-size: 120%;
		text-align: center;
		margin: auto;
		display: block;
	}
	#ErrorMessage {
		background-color: hotpink;
		font-size: 120%;
		text-align: center;
		color: yellow;
		width: 100%;
		margin: auto;
		display: block;
		border: 2px solid red;
	}
	#MessageDiv {
		border: 2px solid green;
		background-color: lightgreen;
	}
	#ExclusionMessage,
	#UseExclusionOption {
		font-size: 120%;
		text-align: center;
		width: 100%;
		margin: auto;
		display: none; //inline-block;
	}
	.help {
		background-color: lightgreen;
		border: 1px solid black;
		border-radius: 0.5em;
		width: 2em;
		cursor: pointer;
	}
	.helpText {
		font-style: italic;
		display: none;
		background-color: lightgreen;
		border: 1px solid black;
		padding: 3px;
		margin-top: 5px;
	}
	#HomeTable {
		margin: auto;
		border: 1px solid grey
	}
	#HomeTable tr td {
		border-bottom: 1px solid grey;
	}
	#HomeTable tr td:nth-child(4) {
		border-left: 2px solid grey;
		padding-left: 5px;
	}
	#HITotal {
		width: 100%;
		text-align: center;
		font-size: 120%;
		font-weight: bold;
	}
	
	@media print {
		.doPrint {
			display: block !important;
			margin-top: 1em !important;
			page-break-inside: avoid;
		}
		.noPrint { display: none !important; }
		html { background-color: white; font-size: 0.8em; }
		body {
			font-size: 0.75em;
			background-color: white;
			padding:0;
			margin: auto; }
		input, select, option { font-size: 0.75em; }
		table { background-color: white; }
		button { display: none; }
	}
</style>

<script type="text/javascript">
	var VERSION;
	// --------------------------------------------------------------------------------
	// Contributors:
	//	Kenny Hayes 		Maggie Barrington	Bob Goings
	//	Mark Riley		Allan Goldberg		Bill Zlobik
	//	Ben Seidman		Brian McCann		John Broughton
	//	Kurt Dunphy		Jeff Caro		Jheroen Dorenbosch
	//	Pat Hannifin		Rebecca Spohn
	// --------------------------------------------------------------------------------

	VERSION = "(Version 3.00, 5/27/2024)";
	//	Major restructuring
	//	Fixed home purchase details not totalling when details changed

	var InputList = [];
	var TPExclusion = 250000;
	var SPExclusion = 250000;
	var TPExclusionApplies = true;
	var SPExclusionApplies = true;
	var PartialExclusionApplies = false;
	var OutOfScope = false;
	var Remodels = [];
	var HasSpouse = false;
	var InheritMessage = "Verify the date inherited.\n\nIt may not be the date of death\n\n(See Pubs 523 and 4895)";
	var InheritMessageShown = false;
	var Sale_Date = [];
	var Purchased_Date = [];
	var TPFiveYears;
	var SaleDateDays = 0;
	var PurchDateDays = 0;
	var _ThisYear = +Date("Y");
	var FS, FileMFS, FileMFJ; // FilingStatus


//----------------------------------------------------------------------------------------
function Initialize() {
// This function sets up a few things to get things going
//----------------------------------------------------------------------------------------
	// Set some defaults
	SaleDate.value = "";
	ErrorMessage.innerHTML = "Please enter Date sold and Date obtained";
	ErrorMessage.style.display = "block";
	Add_Remodel(); // Adds the first remodel line on the home improvements tab

	// for testing...
		//SaleDate.value = "2024-05-17";
		//PurchaseDate.value = "2000-05-05";
		//SalePrice.value = 1000000;
		//PurchasePrice.value = 600000;

	Tab_Click("InfoDiv");
	TPName.click();
}

//----------------------------------------------------------------------------------------
function Basis_Calc(e) {
//	e = the event object for what was clicked or changed
//----------------------------------------------------------------------------------------
	if (e === undefined) return;

	// get the id for whatever just changed
	changingId = e.target.id;

	FS = FilingStatus.value;
	FileMFJ = (FS === "MFJ");
	FileMFS = (FS === "MFS");

	switch (changingId) {

	// Allow setting name and filing status before purchase and sale dates
	case "TPName":
	case "FilingStatus":
		SaleMFSNotice.style.display = (FileMFS) ? "block" : "none" ;
		CostMFSNotice.style.display = (FileMFS) ? "block" : "none" ;
		HomeMFSNotice.style.display = (FileMFS) ? "inline" : "none" ;
		if (SaleDate.value == "") return;
		if (PurchaseDate.value == "") return;
		break;

	// Format purchase and sale dates for later questions
	case "SaleDate":
		if (SaleDate.value == "") return;
		Sale_Date = SaleDate.value.split("-");
		Mo = +Sale_Date[1];
		Dy = +Sale_Date[2];
		Yr = +Sale_Date[0];
		if (Yr < 1900) return; // entry not complete
		SaleDateDays = new Date(Sale_Date);
		TSSaleDate.innerHTML =
		OwnFiveYears2.innerHTML = 
		SPFiveYears2.innerHTML =
		TPFiveYears2.innerHTML = 
		BusinessSoldDate.innerHTML =
		RemarriedDate.innerHTML =
		SPDiedDate2.innerHTML = DateSold.innerHTML = Mo + "/" + Dy + "/" + Yr;
		SPDiedDate1.innerHTML = LookbackTwoYears.innerHTML = Mo + "/" + Dy + "/" + (Yr - 2);
		OwnFiveYears1.innerHTML = 
		SPFiveYears1.innerHTML =
		TPFiveYears1.innerHTML = 
		TPFiveYears = Mo + "/" + Dy + "/" + (Yr - 5);
		// no break;
	case "PurchaseDate":
		if (PurchaseDate.value == "") return;
		Purchased_Date = PurchaseDate.value.split("-");
		Mo = +Purchased_Date[1];
		Dy = +Purchased_Date[2];
		Yr = +Purchased_Date[0];
		if (+Yr < 1900) return; // entry not complete
		PurchDateDays = new Date(Purchased_Date);
		TSPurchaseDate.innerHTML =
		DivorcedDate1.innerHTML =
		DateAcquired.innerHTML = Mo + "/" + Dy + "/" + Yr;
		DivorcedDate2.innerHTML = TSSaleDate.innerHTML;
		break;

	case "SPDiedY":
	case "SPDiedN":
		if (SaleDate.value == "") return;
		if (PurchaseDate.value == "") return;
		SPImprovementsPrior.innerHTML =
		SPImprovementsAfter.innerHTML =
		InstructionText2.innerHTML = "the spouse died."
		break;

	default: break;
	}

	// Require dates of purchase and sale before moving ahead
	if (SaleDate.value == "") {
		alert ("Please enter the date sold first.");
		Tab_Click("InfoDiv");
		return;
	}
	if (PurchaseDate.value == "") {
		alert ("Please enter the date obtained.");
		Tab_Click("InfoDiv");
		return;
	}

	ErrorMessage.innerHTML = "";

	// Initialize variables that are tested later
	inherit2010 = false;
	SpouseApplies = false;


	// Taxpayer information section -----------------------------------------------

	// Set relevant dates based on date of sale

	DaysOwned.innerHTML = "";

	// Check validity of purchase and sale dates
	if (PurchaseDate.value > SaleDate.value) {
		alert ("The date purchased/inherited cannot be later than the date sold.");
		DaysOwned.innerHTML = "Date error";
		return;
	}

	// Calculate how many days the property was owned
	OwnedDays = Math.round((SaleDateDays.valueOf() - PurchDateDays.valueOf()) / (1000 * 24 * 60 * 60))
	if (OwnedDays) DaysOwned.innerHTML = "(Owned for " + OwnedDays + " days)";
	TSTPDaysOwned.innerHTML = OwnedDays;
	FiveYearDays = (5 * 365) + 2;
	// Don't count leap year days
	OwnedDays = Math.min(OwnedDays, FiveYearDays, 1825);
	LT730 = "&lt; 730";
	TSTPTwoYears.innerHTML = (TPTwoYearsY.checked) ? OwnedDays : LT730 ;
	TSSPTwoYears.innerHTML = (SPTwoYearsY.checked) ? OwnedDays : LT730 ;
	TSSPOwner.innerHTML = TSTPOwner.innerHTML = (OwnerY.checked) ? OwnedDays : LT730 ;
	if (OwnedDays < 730) OwnerN.checked = true;

	// Points paid by seller varies by date and whether used as a deduction
	PointsBySellerComment.innerHTML = "";
	PointsBySeller.disabled = true;
	if (Purchased_Date > "1991-12-31") {
		if (Purchased_Date < "1994-04-04") {
			PointsBySellerComment.innerHTML = "If taken as a deduction in the " + Yr + " tax return";
		}
		PointsBySeller.disabled = false;
		PointsBySellerRow.style.display = "table-row";
	}
	else PointsBySeller.value = "";

	// Special situation if inherited in 2010
	inherit2010 = ((+Purchased_Date[0] == 2010) && (Inherit.checked));
	if ((inherit2010) && (! InheritMessageShown)) {
		alert(InheritMessage);
		InheritMessageShown = true;
	}

	// First-time homebuyer question on taxslayer input form
	// Just Yes or No - no determination of amount to be entered is made
	ShowFTHB = ((+Purchased_Date[0] > 2007) && (+Purchased_Date[0] < 2012));
	TSHBCredit.innerHTML = (ShowFTHB) ? "Check if true" : "No" ;
	for (j = 0 ; j < FTHBList.length ; j++) {
		FTHBList[j].style.display = (ShowFTHB) ? "table-row" : "none" ;
	}
	
	// Determine which lines to show and add various messaging as appropriate
	switch (true) {
	case Purchase.checked:
		CostType2.innerHTML = "Purchase price:";
		CostType2Comment.innerHTML = "";
		break;
	case Inherit.checked:
		CostType2.innerHTML = "Inherited value:";
		CostType2Comment.innerHTML = "(Value listed on Form 706. If no Form 706, appraised value)";
		break;
	case Gift.checked:
		CostType2.innerHTML = "Gift value:";
		CostType2Comment.innerHTML = "(Usually donor&apos;s adjusted basis but see Pub 523 for exceptions)";
		break;
	case LikeKind.checked:
		CostType2.innerHTML = "Property value";
		CostType2Comment.innerHTML = "(Out of Scope)";
	}

	PartialRow.style.display = "none";
	if (MainY.checked) {
		HomeType.innerHTML = "Main home"
		Sale5yrDate = (Sale_Date[0] - 5) + "-" + Sale_Date[1] + "-" + Sale_Date[2];
		if (PurchaseDate.value < Sale5yrDate) {
			partialdates = "between ";
			partialdates += ((Purchased_Date[0] > 2008) ? DateAcquired.innerHTML : "1/1/2009" );
			partialdates += " and " + TPFiveYears; // CONTRAVERSIAL
			PartialDates.innerHTML = partialdates;
			PartialRow.style.display = "table-row";
		}
		else {
			PartialRow.style.display = "none";
			PartialN.checked = true;
		}
		OwnershipTestRow.style.display = "table-row";
		OwnerRow.style.display = "table-row";
		ResidencyTestRow.style.display = "table-row";
		TPFiveYearsRow.style.display = "table-row";
		SPFiveYearsRow.style.display = "table-row";
		LookbackTestRow.style.display = "table-row";
		LookbackRow.style.display = "table-row";
		PostponedRow.style.display = "table-row";
	}
	else {
		HomeType.innerHTML = "Secondary home"
		OwnershipTestRow.style.display = "none";
		OwnerRow.style.display = "none";
		ResidencyTestRow.style.display = "none";
		TPFiveYearsRow.style.display = "none";
		SPFiveYearsRow.style.display = "none";
		LookbackTestRow.style.display = "none";
		LookbackRow.style.display = "none";
		PartialRow.style.display = "none";
		PartialN.checked = true;
		PostponedRow.style.display = "none";
		UnforseenRow.style.display = "none";
	}
	LookbackSpouse.style.display = (MainY.checked && (FileMFS || FileMFJ)) ? "inline" : "none";

	if (FileMFJ) {
		OwnerSpouse.style.display = "inline";
		TSSPTwoYearsRow.style.display = "table-row";
		TSSPOwnerRow.style.display = "table-row";
		TSSPLookbackDaysRow.style.display = "table-row"
		TSSPQualifiesRow.style.display = "table-row";
		TSSPDiedExclusionRow.style.display = "none";
	}
	else {
		OwnerSpouse.style.display = "none"
		TSSPTwoYearsRow.style.display = "none";
		TSSPOwnerRow.style.display = "none";
		TSSPLookbackDaysRow.style.display = "none";
		TSSPQualifiesRow.style.display = "none";
		TSSPDiedExclusionRow.style.display = "table-row";
	}

	if (OwnedJointlyY.checked) {
		SpouseApplies = true;
		SPDiedRow.style.display = "table-row";
		DivorcedRow.style.display = "table-row";
	}
	else {
		SPDiedRow.style.display = "none";
		DivorcedRow.style.display = "none";
		SPDiedN.checked = true;
		DivorcedN.checked = true;
		SPJobRelocRow.style.display = "none";
		SPExtendedDutyRow.style.display = "none";
	}

	if (DivorcedY.checked) {
		if (PurchaseDate.value < "1984-07-18") {
			DateDivorcedRow.style.display = "table-row";
			}
		else {
			DateDivorcedRow.style.display = "none" ;
			DateDivorcedY.checked = true;
		}
		SPDiedRow.style.display = "none";
		SPDiedN.checked = true;
		SPImprovementsPrior.innerHTML =
		SPImprovementsAfter.innerHTML =
		InstructionText2.innerHTML = "the divorce"
	}
	else {
		if (OwnedJointlyY.checked) SPDiedRow.style.display = "table-row";
		DateDivorcedRow.style.display = "none";
		DateDivorcedN.checked = true;
	}

	if (SPDiedY.checked) {
		RemarriedRow.style.display = "table-row";
		TPTwoYearsRemarried.style.display = (RemarriedY.checked) ? "inline" : "none" ;
		Current1.innerHTML = Current2.innerHTML = (RemarriedY.checked) ? "current" : "late" ;
	}
	else {
		RemarriedRow.style.display = "none";
		RemarriedN.checked = true;
		TPTwoYearsRemarried.style.display = "none";
		Current1.innerHTML = Current2.innerHTML = "";
	}

	if (OwnerY.checked) {
		if (MainY.checked && (FileMFS || FileMFJ)) SPFiveYearsRow.style.display = "table-row";
		UnforseenRow.style.display = "none";
		UnforseenN.checked = true;
	}
	else {
		if (MainY.checked) UnforseenRow.style.display = "table-row";
	}

	if (UnforseenY.checked) {
		TPJobRelocRow.style.display = "none";
		SPJobRelocRow.style.display = "none";
		TPExtendedDutyRow.style.display = "none";
		SPExtendedDutyRow.style.display = "none";
		TPTwoYearsY.checked = true;;
		SPTwoYearsY.checked = true;;
	}
	else {
		if (MainY.checked) TPFiveYearsRow.style.display = "table-row";
		if (TPTwoYearsN.checked) {
			TPJobRelocRow.style.display =  "table-row";
			TPExtendedDutyRow.style.display = "table-row";
		}
		else {
			TPJobRelocRow.style.display =  "none";
			TPExtendedDutyRow.style.display = "none";
		}
		if ((SPTwoYearsN.checked) && (SPDiedN.checked || RemarriedY.checked)) {
			SPJobRelocRow.style.display =  "table-row";
			SPExtendedDutyRow.style.display = "table-row";
		}
		else {
			SPJobRelocRow.style.display = "none";
			SPExtendedDutyRow.style.display = "none";
		}

	}

	// Determine exclusion eligibility
	OutOfScope = false;
	TPExclusionApplies = true;
	SPExclusionApplies = FileMFJ || SPDiedY.checked;
	PartialExclusionApplies = false;
	TPPartialExclusionApplies = false;
	SPPartialExclusionApplies = false;

	// MAIN HOME
	if (MainN.checked) TPExclusionApplies = SPExclusionApplies = false;

	// OWNERSHIP
	if (OwnedDays < 730) TPExclusionApplies = SPExclusionApplies = false;
	if ((OwnerN.checked) && (UnforseenN.checked)) TPExclusionApplies = SPExclusionApplies = false;
	if (UnforseenY.checked) TPPartialExclusionApplies = SPPartialExclusionApplies = true;

	// RESIDENCY
	TPexception = (TPJobRelocY.checked || TPExtendedDutyY.checked);
	SPexception = (SPJobRelocY.checked || SPExtendedDutyY.checked);
	if (RemarriedN.checked) {
		if ((TPTwoYearsN.checked) && (SPTwoYearsN.checked)) SPExclusionApplies = TPExclusionApplies = false;
	}
	else {
		if (SPTwoYearsN.checked) SPExclusionApplies = false;
		if (SPexception) SPPartialExclusionApplies = true;
		if (TPTwoYearsN.checked) TPExclusionApplies = false;
		if (TPexception) TPPartialExclusionApplies = true;
	}
	if (SPDiedY.checked && RemarriedN.checked) TSTPQualifies.innerHTML = TSSPQualifies.innerHTML;

	// LOOKBACK
	if (LookbackY.checked) {
		TPExclusionApplies = SPExclusionApplies = false;
		TPPartialExclusionApplies = SPPartialExclusionApplies = true;;
	}

	if (LikeKind.checked) OutOfScope = true;
	if (Inherit.checked && MainN.checked) OutOfScope = true;
	if (Gift.checked && MainN.checked) OutOfScope = true;
	if (PostponedY.checked) OutOfScope = true;
	if (RentalY.checked) OutOfScope = true;
	if (PartialY.checked) OutOfScope = true;


	if (MainN.checked) TPPartialExclusionApplies = SPPartialExclusionApplies = false;
	PartialExclusionApplies = PartialExclusionApplies || TPPartialExclusionApplies || SPPartialExclusionApplies;

	// Home sale details tab -------------------------------------------------------------

	// Check inputs
	SalePrice.style.backgroundColor = (SalePrice.value) ? "white" : "hotpink" ;

	// Round all inputs
	InputList = document.getElementsByClassName("datain");
	actEl = document.activeElement;
	for (i in InputList) {
		if (InputList[i] != actEl) {
			ilval = Math.round(InputList[i].value);
			InputList[i].value = (ilval) ? ilval : "" ; // blank for 0
		}
	}

	// Form 1099S ?
	if (F1099SY.checked) {
		DebtsRow.style.display = "none";
		RETaxesRow.style.display = "none";
		OtherValueComment.innerHTML = "(eg: value of property/services if Form 1099-S box 4 is checked)";
		SalePriceComment.innerHTML = "Enter amount from Form 1099-S box 2";
		SaleExpenseComment.innerHTML = " (Do not enter any expense included in Form 1099-S box 2 above)";
		Debts.value = "";
		RETaxes.value = "";
	}
	else {
		DebtsRow.style.display = "table-row";
		RETaxesRow.style.display = "table-row";
		OtherValueComment.innerHTML = "";
		SalePriceComment.innerHTML = "Do not include payment for personal property (furniture, etc)";
		SaleExpenseComment.innerHTML = "";
	}

	SalePriceLabel.innerHTML = (InstallmentY.checked) ? "Sale amount" : "Money received" ;

	// Form 1099C ?
	if (F1099CY.checked) {
		BankruptRow.style.display = "table-row";
		if (BankruptY.checked) OutOfScope = true;
	}
	else {
		BankruptRow.style.display = "none";
		BankruptN.checked = true;
	}

	// Total the inputs
	SellingPrice = +SalePrice.value + +Debts.value + +RETaxes.value + +OtherValue.value;
	SaleExpenses = +Realtor.value + +Advertising.value + +Legal.value + +BuyerExpense.value + +OtherExpense.value;

	// Home purchase details tab -----------------------------------------------

	// Check inputs
	PurchasePrice.style.backgroundColor = (PurchasePrice.value) ? "white" : "hotpink" ;
	DiedFMV.style.backgroundColor = (SPDiedY.checked && (DiedFMV.value == 0)) ? "hotpink" : "white" ;

	// Figure the basis to be used

	if (SPDiedY.checked) { // adjust the basis on date of death
		DiedBasisRow1.style.display = "table-row";
		DiedBasisRow2.style.display = "table-row";
		DiedBasisRow4.style.display = "table-row";
		CPSQuestion.style.display = "inline"; // Community property state
		DiedBasisRow3.style.display = (SPDiedCommunityPropertyState.checked) ? "none" : "table-row" ;
		if (SPDiedY.checked) {
			DiedBasis1.innerHTML = "Home improvements before spouse died:";
			DiedBasis3.innerHTML = "Adjusted basis before spouse died:";
			DiedBasis2.innerHTML = "Fair market value when spouse died:";
			DiedBasis4.innerHTML = "Adjusted basis after spouse died:";
		}
	}
	else if (DivorcedY.checked) { // adjust the basis on date of divorce
		if (DateDivorcedY.checked) {
			DiedBasisRow1.style.display = "table-row";
			DiedBasis1.innerHTML = "Home improvements before the divorce:";
			DiedBasisRow2.style.display = "none";
			DiedBasisRow3.style.display = "table-row";
			DiedBasis3.innerHTML = "Adjusted basis after the divorce:";
			DiedBasisRow4.style.display = "none";
			CostType2Comment.innerHTML = "";
		}
		else {
			DiedBasisRow1.style.display = "none";
			DiedBasisRow2.style.display = "table-row";
			DiedBasis2.innerHTML = "Fair market value when divorced:";
			DiedBasisRow3.style.display = "none";
			DiedBasisRow4.style.display = "none";
			CostType2Comment.innerHTML = "Use home value when divorced";
		}
		DiedBasisComment.innerHTML = "";
		CPSQuestion.style.display = "none";
	}
	else {
		DiedBasisRow1.style.display = "none";
		DiedBasisRow2.style.display = "none";
		DiedBasisRow3.style.display = "none";
		DiedBasisRow4.style.display = "none";
		CPSQuestion.style.display = "none";
		SPDiedCommunityPropertyState.checked = false;
		DiedBasis2.innerHTML = "";
	}

	// Home improvements tab ----------------------------------------------

	// Add a remodeling project line if needed
	// The first was added in the Initialization function
	if (Remodels[Remodels.length - 1].value != "") Add_Remodel();

	// Make display adjustments for a deceased or divorced spouse
	SplitResults = SPDiedY.checked || DivorcedY.checked;
	Results.style.display = (SplitResults) ? "none" : "inline" ;
	ResultsBoth.style.display = (SplitResults) ? "inline" : "none" ;
	Instruction2.style.display = (SplitResults) ? "inline" : "none" ;
	for (DoDcb = 0; DoDcb < HomeImprovementDoD.length; DoDcb++) { // show the checkboxes
		HomeImprovementDoD[DoDcb].style.display = (SplitResults) ? "inline" : "none" ;
	}

	// Total all improvements
	var ImproveTotal = 0;
	var PreDoDImproveTotal = 0;
	var AssessmentTotal = 0; // A subtotal for use with TaxSlayer input only
	for (i = 0 ; i < HomeImprovementList.length ; i++) {
		// See if the checkbox in the next column is checked
		if (HomeImprovementList[i].parentElement.nextElementSibling.firstChild.checked) {
			ImproveTotal += +HomeImprovementList[i].value;
		}
		else {
			PreDoDImproveTotal += +HomeImprovementList[i].value;
		}

		// Is "Assessment" one of the classes for this home improvement element
		ClassList = HomeImprovementList[i].classList.value;
		if (ClassList.indexOf("Assessment") != -1) { // found one
			AssessmentTotal += +HomeImprovementList[i].value;
		}
	}

	// Checkboxes may not be cleared if set during testing or comparison
	ImproveTotal = Math.round(ImproveTotal + ((SplitResults) ? 0 : PreDoDImproveTotal ));

	ImproveAmount.value = HomeImprovementTotal.innerHTML = ImproveTotal;
	PreImproveAmount.value = HomeImprovementPrior.innerHTML = Math.round(PreDoDImproveTotal);
	HomeImprovementAfter.innerHTML = ImproveTotal;
	TSImproveAmount.innerHTML = ImproveTotal - AssessmentTotal;

	// Basis calculations on the Home Cost tab -----------------------------------------

	ClosingCosts = +LegalFee.value + +SurveyFee.value + +TitleFee.value
		+ +SellerFee.value + +AbstractFee.value + +StampFee.value + +OtherFee.value;
	PurchaseExpensesTotal.value = ClosingCosts;

	BasisDecrease = +Easements.value + +EnergyCredits.value + +AdoptionCredits.value;
	BasisDecrease += +RETaxesBySeller.value + +PointsBySeller.value;
	BasisDecrease += +SalesTaxOnHome.value + +OtherAdjustments.value;
	TotalAdjusted.value = BasisDecrease;

	switch (true) {
	case DivorcedY.checked:
		if (DateDivorcedN.checked) {
			DiedBasis.value = 
			Basis.value =
		       	basis = +DiedFMV.value;
		}
		else {
			DivorceBasisAmount = +PurchasePrice.value + ClosingCosts - BasisDecrease + PreDoDImproveTotal;
			DiedBasis.value = DivorceBasisAmount;
			basis = Math.round(DivorceBasisAmount);
			Basis.value = basis;
			TSIncreases.innerHTML = Math.max(0, Math.round(basis - +PurchasePrice.value));
		}
		break;
	case SPDiedY.checked:
		DiedBasisAmount = +PurchasePrice.value + ClosingCosts - BasisDecrease + PreDoDImproveTotal;

		if (SPDiedCommunityPropertyState.checked) {
			DiedBasis.value = 
			Basis.value =
		       	basis = +DiedFMV.value; 
		}
		else {
			basis = Math.round(50 * (+DiedFMV.value + +DiedBasisAmount)) / 100;
			DiedBasis.value = DiedBasisAmount;
			Basis.value = basis;
			TSIncreases.innerHTML = Math.max(0, Math.round(basis - +PurchasePrice.value));
		}
		break;
	default:
		basis = +PurchasePrice.value + ClosingCosts - BasisDecrease;
	}

	// The final cost basis for determining profit or loss
	AdjustedCostBasis.value = AdjustedBasis = basis + ImproveTotal; 

	// TaxSlayer entry figures -----------------------------------------------

	// Populate TaxSlayer entry tables and calculate totals based on Worksheet 1
 	//	(// # are worksheet line numbers)
 	TSPurchasePrice.innerHTML = +PurchasePrice.value; // 1, 2, 3
	TSLegalFee.innerHTML = +LegalFee.value; // 4b
	TSSurveyFee.innerHTML = +SurveyFee.value; // 4c
	TSTitleFee.innerHTML = +TitleFee.value; // 4d
	TSSellerFee.innerHTML = +SellerFee.value; // 4f
	TSOtherFee.innerHTML = +OtherFee.value; // 4g
	TSAbstractFee.innerHTML = +AbstractFee.value;
	TSStampFee.innerHTML = +StampFee.value;
	// ClosingCosts; // 5 
	TSTaxFee.innerHTML = AssessmentTotal; // 7
	//BasisDecrease; // 8
	TSTotalAdjusted.innerHTML = BasisDecrease;
	Cost.innerHTML = TSHCAdjustedBasis.innerHTML = AdjustedBasis;
	AdjReason = "";

	// Taxable gain based on Worksheet 2 (// # are worksheet line numbers)
	TSSalePriceTotal.innerHTML = SellingPrice; // 1
	TSHCSalePriceTotal.innerHTML = SellingPrice;
	SalePriceTotal.value = SellingPrice;
	SalesPrice.innerHTML = SellingPrice;
	SaleExpensesTotal.value = SaleExpenses; // 2
	TSHCSaleExpensesTotal.innerHTML = SaleExpenses;
	TSSaleExpensesTotal.innerHTML = SaleExpenses;
	AmountRealized = SellingPrice - SaleExpenses; // 3
	SaleGain = AmountRealized - AdjustedBasis; // 5

	// Display result ----------------------------------------------------
	ExclusionMessage.style.display = "none";
	ErrorMessage.style.display = "none";
	QualificationMessage.style.display = "none";
	UseExclusionOption.style.display = "none";
	TSInputDiv.style.display = "block";

	// Check for errors
	if (OutOfScope) {
		if ((! TPExclusionApplies) && (! SPExclusionApplies)) {
			QualificationMessage.innerHTML = "You do not qualify for an exclusion";
		}
		else {
			QualificationMessage.innerHTML = "An exclusion may be available";
		}
		QualificationMessage.style.display = "block";
		ErrorMessage.innerHTML = "Your situation is beyond the scope of this worksheet";
		ErrorMessage.style.display = "block";
		TSInputDiv.style.display = "none";
		return;
	}

	if (PartialExclusionApplies) {
		QualificationMessage.innerHTML = "A partial exclusion may be available";
		QualificationMessage.style.display = "block";
		ErrorMessage.innerHTML = "Your situation is beyond the scope of this worksheet";
		ErrorMessage.style.display = "block";
		TSInputDiv.style.display = "none";
		return;
	}

	if ((PurchaseDate.value == "")
		|| (AmountRealized == 0)
		|| (AdjustedBasis == 0)
		|| ((SPDiedY.checked || DivorcedY.checked) && DiedFMV.value == 0)) {
		if ((! TPExclusionApplies) && (! SPExclusionApplies)) {
			QualificationMessage.innerHTML = "You do not qualify for an exclusion";
		}
		else {
			QualificationMessage.innerHTML = "An exclusion may be available";
		}
		QualificationMessage.style.display = "block";
		reason = (PurchaseDate.value) ? "need sale and purchase details" : "Date obtained" ;
		ErrorMessage.innerHTML = "Insufficient data to determine taxability (" + reason + ")";
		ErrorMessage.style.display = "block";
		TSInputDiv.style.display = "none";
		return;
	}

	if ((! TPExclusionApplies) && (! SPExclusionApplies)) {
		QualificationMessage.innerHTML = "You do not qualify for an exclusion but you may continue to determine taxability";
		QualificationMessage.style.display = "block";
	}

	// Determine the exclusion amount available
	MaxExclAmt = 0;
	if (TPExclusionApplies) {
		MaxExclAmt += TPExclusion;
		TSTPQualifies.innerHTML = (TPPartialExclusionApplies) ?  "(Partial)" : "Yes";
		TSDiedExclusion.innerHTML = "No";
	}
	else {
		TSTPQualifies.innerHTML = "No";
	}

	if (SPExclusionApplies) {
		MaxExclAmt += SPExclusion;
		TSSPQualifies.innerHTML = (SPPartialExclusionApplies) ?  "(Partial)" : "Yes";
		TSDiedExclusion.innerHTML = "No";
	}
	else {
		TSSPQualifies.innerHTML = "No";
	}

	ExcludableGain = Math.max(0, SaleGain); // 7, 12
	MaximumExclusion = MaxExclAmt // 13
	MaxExclAmt = Math.min(MaxExclAmt, ExcludableGain); //14
	ExclusionApplies = (MaxExclAmt) ? true : false ;
	ExclusionMessage.style.display = "none";

	// Display exclusion messages
	if (SaleGain >= 0) {
		if (ExclusionApplies) {
			ExclusionMessage.innerHTML = "An exclusion of $" + MaxExclAmt + " is available for this home sale";
			UseExclusionOption.style.display = "block";
		}
		else {
			ExclusionMessage.innerHTML = "";
		}
		ExclusionMessage.style.display = "block";
	}
	else {
		ExclusionMessage.innerHTML = "This sale resulted in a nondeductible loss of $" + Math.abs(SaleGain + SaleExpenses);
		ExclusionMessage.style.display = "block";
		TSDiedExclusion.innerHTML = "No";
		TSChoices.style.display = "inline";
	}

	// Determine the breakdown and coding for the adjustment
	AdjustmentDetail.innerHTML = "";
	var AdjReason = "";
	var AdjAmount = 0;
	var ExclAmount = 0;
	var HDetail = "";
	var EDetail = "";
	var AdjDetail = "";

	if (SaleExpenses) {
		AdjReason = "E";
		EDetail = "Sale Expenses = " + SaleExpenses;
		AdjAmount = -Math.min(SaleExpenses, SaleGain);
	}

	if ( MainY.checked && UseExclusionY.checked ) {
		AdjReason += "H";
		ExclAmount = MaxExclAmt;
		if (ExclAmount) HDetail = "Exclusion = " + ExclAmount;
		TSDiedExclusion.innerHTML = (ExclAmount > TPExclusion) ? "Yes" : "No" ;
	}

	AdjAmount = ExclAmount + SaleExpenses;
	AdjDetail = HDetail + ( (SaleExpenses && ExclAmount) ? ", " : "" ) + EDetail;

	if (SaleGain > 0) { // Gain
		GainOrLoss.innerHTML = Math.max(0, SaleGain - ExclAmount);
	}

	if (SaleGain < 0) { // Loss

		AdjAmount = -(SaleGain + SaleExpenses);

		if (SaleExpenses < AdjAmount) {
			AdjDetail = "Adjustment to remove the nondeductible loss";
			AdjReason = "L";
		}
		else {
			AdjDetail = "Sale Expenses = " + Math.abs(AdjAmount);
		}

		AdjAmount = -AdjAmount;
		GainOrLoss.innerHTML = 0;
	}

	AdjustmentDetail.innerHTML = (AdjDetail) ? ( "(" + AdjDetail + ")" ) : "" ;
	Adjustments.innerHTML = -AdjAmount;
	AdjustmentReason.innerHTML = AdjReason;

	// Determine what TaxSlayer entry tables to display
	UWOptionText.style.color = "black";
	UseWorksheet.disabled = false;
	UWOptionText.style.textDecoration = "none";

	if (! ExclusionApplies) UseExclusionN.checked = true;

	if (UseExclusionN.checked) {
		UseWorksheet.disabled = true;
		UWOptionText.style.textDecoration = "line-through";
		UseSchedD.checked = true;
	}

	TSChoices.style.display = "inline";
	TSNoNeedToEnter.style.display = "none";
	switchCode = (F1099SY.checked) ? "F" : "";
	switchCode += (SaleGain > MaxExclAmt) ? "T" : ""; // Taxable

	switch (switchCode) {
	case "":
		if ((ExclusionApplies) || (SaleGain < 0)) TSNoNeedToEnter.style.display = "block";
		else NoNeedButShow.checked = true;
		UseWorksheet.disabled = "disabled";
		UWOptionText.style.textDecoration = "line-through";
		UseSchedD.checked = true;
		if (! NoNeedButShow.checked) {
			TSChoices.style.display = "none" ;
			UseSchedD.checked = false;
			UseWorksheet.checked = false;
		}
		break;
	case "F":
		if (SaleGain < 0) {
			UseWorksheet.disabled = "disabled";
			UWOptionText.style.textDecoration = "line-through";
			UseSchedD.checked = true;
		}
		break;
	case "FT":
	case "T":
	default:
	}

	// Display the entry table the user chooses
	TSWorksheet.style.display = (UseWorksheet.checked) ?  "block" : "none" ;
	SchedD.style.display = (UseSchedD.checked) ?  "block" : "none" ;
}
//----------------------------------------------------------------------------------------
function Tab_Click(id) {
//	Change the working tab
//----------------------------------------------------------------------------------------
	InfoDivElement.style.display = "none";
	InfoDivTabElement.style.top = "0";
	SaleDivElement.style.display = "none";
	SaleDivTabElement.style.top = "0";
	CostDivElement.style.display = "none";
	CostDivTabElement.style.top = "0";
	HomeDivElement.style.display = "none";
	HomeDivTabElement.style.top = "0";

	// Prevent tab change if various dates have not been entered
	if (id !== "InfoDiv") {
		if (SaleDate.value == "") {
			alert ("Please enter the home sale date first.");
			Tab_Click("InfoDiv");
			return;
		}
		if (PurchaseDate.value == "") {
			alert ("Please enter the date obtained first.");
			Tab_Click("InfoDiv");
			return;
		}
	}

	switch (id) {
	case "InfoDiv":
		InfoDivElement.style.display = "block";
		InfoDivTabElement.style.zIndex = "2";
		InfoDivTabElement.style.top = "2px";
		TPName.focus();
		break;
	case "SaleDiv":
		SaleDivElement.style.display = "block";
		SaleDivTabElement.style.zIndex = "2";
		SaleDivTabElement.style.top = "2px";
		SalePrice.focus();
		break;
	case "CostDiv":
		CostDivElement.style.display = "block";
		CostDivTabElement.style.zIndex = "2";
		CostDivTabElement.style.top = "2px";
		PurchasePrice.focus();
		break;
	case "HomeDiv":
		HomeDivElement.style.display = "block";
		HomeDivTabElement.style.zIndex = "2";
		HomeDivTabElement.style.top = "2px";
		break;
	}
}

//----------------------------------------------------------------------------------------
function Add_Remodel() {
	// Adds a new row to the home remodeling list when the last one is used
//----------------------------------------------------------------------------------------
	RemodleNumber = Remodels.length + 1;
	new_tr = document.createElement("tr");
		HomeTableElement.appendChild(new_tr);
		new_td = document.createElement("td");
			new_tr.appendChild(new_td);
			new_input = document.createElement("input");
				new_td.appendChild(new_input);
				new_input.type = "text";
				new_input.placeholder = "(Description)";
				new_input.className = "Improve";
				new_input.id = "Improve" + RemodleNumber;
		new_td = document.createElement("td");
			new_tr.appendChild(new_td);
			new_text = document.createElement("text");
				new_td.appendChild(new_text);
				new_text.innerHTML = "$";
			new_input = document.createElement("input");
				new_td.appendChild(new_input);
				Remodels[RemodleNumber] = new_input; // list of amount elements
				new_input.type = "number";
				new_input.id = "ImproveAmount" + RemodleNumber;
				new_input.className = "datain HomeImprovement";
		new_td = document.createElement("td");
			new_tr.appendChild(new_td);
			new_input = document.createElement("input");
				new_td.appendChild(new_input);
				new_input.type = "checkbox";
				new_input.className = "datain ImprovementAfterDoD";
				new_input.id = "ImproveDoD" + RemodleNumber;
}

</script>

</head>

<!-- ******************************************************************************************************** -->
<!-- **************************************** START OF HTML ************************************************* -->
<!-- ******************************************************************************************************** -->

<body onload="Initialize();">

<center>
	<span class="title">Home Sale Worksheet</span>
	<br /><span id="Version"></span>
	<script>Version.innerHTML = VERSION;</script>
</center>

	<span id="ClearAndPrint" class="noPrint">
	<button onclick="window.open(window.location,'_self');">Clear and reset calculator</button>
	<br /><button onclick="window.print()">Print a taxpayer copy</button>
</span>
<div id="InputDiv" style="position: relative;">

	<div class="tabs noPrint">
		<br />
		<table style="width: 100%;"><tr>
		<td id="InfoDivTab" class="tab" onclick="Tab_Click('InfoDiv');">TP/home&nbsp;information</td>
		<td id="SaleDivTab" class="tab" onclick="Tab_Click('SaleDiv');">Home&nbsp;sale&nbsp;details</td>
		<td id="CostDivTab" class="tab" onclick="Tab_Click('CostDiv');">Home&nbsp;purchase&nbsp;details</td>
		<td id="HomeDivTab" class="tab" onclick="Tab_Click('HomeDiv');">Home&nbsp;improvements</td>
		</tr></table>
	</div>

	<div id="InfoDiv" class="section doPrint" onchange="Basis_Calc(event);">
		<span class="tblHeader">Taxpayer Information:</span>
		<br />
		<br />
		<table class="tblLayout">
			<tr><td class="indent"></td><td></td><td></td></tr>
		<tr><td>Taxpayer&apos;s Name:</td>
			<td colspan="2"><input id="TPName" class="TPName" /></td></tr>
		<tr><td>Filing status this year:</td>
			<td style="text-align:top">
				<select id="FilingStatus"
					title="Select the taxpayer's filing status.">
					<option value="SNG">Single</option>
					<option value="MFJ" selected>MFJ</option>
					<option value="MFS">MFS</option>
					<option value="HOH">HOH</option>
					<option value="QSS">QSS</option></select>
		</td><td></td></tr>
		<tr id="SaleDateRow"><td>Date sold:</td>
			<td><input id="SaleDate" type="date" /></td>
			<td>&#9754; <b>Enter these dates before answering questions below!</b></td></tr>
		<tr><td id="CostType1">Date obtained:</td>
			<td><input id="PurchaseDate" type="date" /></td>
			<td><span id="DaysOwned"></span></td></tr>
		<tr><td>How did you obtain the home:</td>
			<td colspan="2"><input id="Purchase" name="Inherit" type="radio" checked /> Purchase
			<input id="Inherit" name="Inherit" type="radio" /> Inherited
			<input id="Gift" name="Inherit" type="radio" /> Gift
			<input id="LikeKind" name="Inherit" type="radio" /> Like-kind (&sect;1031) exchange</td></tr>
		<tr><td>Was this your main home?</td>
			<td><input id="MainY" name="Main" type="radio" checked /> Yes
				<input id="MainN" name="Main" type="radio" /> No</td>
			<td></td></tr>
		<tr id="OwnedJointlyRow"><td>Was the home jointly owned with a spouse</span>?</td>
			<td><input id="OwnedJointlyY" name="Owned" type="radio" checked /> Yes
				<input id="OwnedJointlyN" name="Owned" type="radio" /> No</td>
			<td>If No, answer questions as if you are the taxpayer.</td></tr>
		<tr id="DivorcedRow"><td class="indent">Were you divorced between
				<span id="DivorcedDate1"></span> and
				<span id="DivorcedDate2"></span>?</td>
			<td><input id="DivorcedY" name="Divorced" type="radio" /> Yes
				<input id="DivorcedN" name="Divorced" type="radio" checked /> No</td>
			<td></td></tr>
		<tr id="DateDivorcedRow" class="hide"><td class="indent">Were you divorced after 7/18/1984</span>?</td>
			<td><input id="DateDivorcedY" name="DateDivorced" type="radio" checked /> Yes
				<input id="DateDivorcedN" name="DateDivorced" type="radio" /> No</td>
			<td></td></tr>
		<tr id="SPDiedRow"><td class="indent">Did that spouse die between
				<span id="SPDiedDate1"></span> and
				<span id="SPDiedDate2"></span>?</td>
			<td><input id="SPDiedY" name="SPDied" type="radio" /> Yes
				<input id="SPDiedN" name="SPDied" type="radio" checked /> No</td>
			<td> <span id="CPSQuestion" class="hide">
				<input id="SPDiedCommunityPropertyState" type="checkbox" />Check if community property state
				</span></td></tr>
		<tr id="RemarriedRow" class="hide"><td class="indent">Were you remarried on
				<span id="RemarriedDate"></span>?</td>
			<td><input id="RemarriedY" name="Remarried" type="radio" /> Yes
				<input id="RemarriedN" name="Remarried" type="radio" /> No</td>
			<td></td></tr>
		<tr id="OwnershipTestRow"><td colspan="3" class="bold italic">OWNERSHIP TEST:</td></tr>
		<tr id="OwnerRow"><td>Did you
				<span id="OwnerSpouse">and/or your <span id="Current1"></span> spouse</span>
				own the home for any 24 months (730 days) between
				<span id="OwnFiveYears1"></span> and
				<span id="OwnFiveYears2"></span></td>
			<td><input id="OwnerY" name="Owner" type="radio" checked /> Yes
				<input id="OwnerN" name="Owner" type="radio" /> No</td>
			<td>Up to 10 years extension for period of duty if on duty outside the US as military, diplomatic,
				intelligence or peace corps (applies to residency also)</td></tr>
		<tr id="UnforseenRow" class="hide"><td class="indent">Due to unforseeable events?</td>
			<td><input id="UnforseenY" name="Unforseen" type="radio" /> Yes
				<input id="UnforseenN" name="Unforseen" type="radio" checked /> No</td>
			<td>(eg: home destroyed, condemned, casualty loss, divorce, legal separation,
				multiple births, loss of employment)</td></tr>
		<tr id="ResidencyTestRow"><td colspan="3" class="bold italic">RESIDENCY TEST:</td></tr>
		<tr id="TPFiveYearsRow"><td>Did you live in the home for any 24 months (730 days) between
				<span id="TPFiveYears1"></span> and
				<span id="TPFiveYears2"></span></td>
			<td><input id="TPTwoYearsY" name="TPTwoYears" type="radio" checked /> Yes
				<input id="TPTwoYearsN" name="TPTwoYears" type="radio" /> No</td>
			<td>Vacations count. Licensed care facilities count if lived in home for 12 months.
				<span id="TPTwoYearsRemarried"class="hide">
					But choose No if you did not own the home during this period.</span></td></tr>
		<tr id="TPJobRelocRow" class="hide">
			<td class="indent">Due to work or health relocation?</td>
			<td><input id="TPJobRelocY" name="TPJobReloc" type="radio" /> Yes
				<input id="TPJobRelocN" name="TPJobReloc" type="radio" checked /> No</td>
			<td>New job location must be at least 50 miles further than old job location for anyone in the home</td></tr>
		<tr id="TPExtendedDutyRow" class="hide">
			<td class="indent">Due to extended qualified government duty?</td>
			<td><input id="TPExtendedDutyY" name="TPExtendedDuty" type="radio" /> Yes
				<input id="TPExtendedDutyN" name="TPExtendedDuty" type="radio" checked /> No</td>
			<td>More than 90 days and at least 50 miles from home</td></tr>
		<tr id="SPFiveYearsRow">
			<td>Did your
				<span id="Current2"></span>
				spouse live in the home for any 24 months (730 days) between
				<span id="SPFiveYears1"></span> and
				<span id="SPFiveYears2"></span></td>
			<td><input id="SPTwoYearsY" name="SPTwoYears" type="radio" checked /> Yes
				<input id="SPTwoYearsN" name="SPTwoYears" type="radio" /> No</td>
			<td>(Notes in previous line apply here too)</td></tr>
		<tr id="SPJobRelocRow" class="hide">
			<td class="indent">Due to work or health relocation?</td>
			<td><input id="SPJobRelocY" name="SPJobReloc" type="radio" /> Yes
				<input id="SPJobRelocN" name="SPJobReloc" type="radio" checked /> No</td>
			<td>New job location must be at least 50 miles further than old job location for anyone in the home</td></tr>
		<tr id="SPExtendedDutyRow" class="hide">
			<td class="indent">Due to extended qualified government duty?</td>
			<td><input id="SPExtendedDutyY" name="SPExtendedDuty" type="radio" /> Yes
				<input id="SPExtendedDutyN" name="SPExtendedDuty" type="radio" checked /> No</td>
			<td>More than 90 days and at least 50 miles from home</td></tr>
		<tr id="LookbackTestRow"><td colspan="3" class="bold italic">LOOKBACK TEST:</td></tr>
		<tr id="LookbackRow"><td>Have you
				<span id="LookbackSpouse">or your spouse</span>
				taken a home sale exclusion since
				<span id="LookbackTwoYears"></span></td>
			<td><input id="LookbackY" name="Lookback" type="radio" /> Yes
				<input id="LookbackN" name="Lookback" type="radio" checked /> No</td>
			<td></td></tr>
		<tr><td colspan="3" class="bold italic">SCOPE TESTS:</td></tr>
		<tr id="PostponedRow"><td>Is there postponed gain or depreciation from a previous home sold prior to 5/7/1997?</td>
			<td><input type="radio" id="PostponedY" name="Postponed" /> Yes
				<input type="radio" id="PostponedN" name="Postponed" checked /> No</td>
			<td></td></tr>
		<tr id="BusinessRow"><td>Was the home ever used for business (including rental for more than 14 days) between 5/6/1997 and
				<span id="BusinessSoldDate"></span></td>
			<td><input type="radio" id="RentalY" name="Rental" /> Yes
				<input type="radio" id="RentalN" name="Rental" checked /> No</td>
			<td></td></tr>
		<tr id="PartialRow">
			<td>Was there any time
				<span id="PartialDates"></span>
				when this home was <u>not</u> used as the main home
				for either taxpayer or spouse?</td>
			<td><input type="radio" id="PartialY" name="Partial" /> Yes
				<input type="radio" id="PartialN" name="Partial" checked /> No</td>
			<td>(Check yes if used as a vacation or second home during this period)</td></tr>
		</table>
	</div>

	<div id="SaleDiv" class="section doPrint" style="margin-top: none;" onkeyup="Basis_Calc(event);" onchange="Basis_Calc(event);">
		<span class="tblHeader">Home sale details:</span>
		<br />&nbsp;
		<span id="SaleMFSNotice">
			When filing Married Filing Seperately, only enter your portion of the amounts below.<br />&nbsp;</span>
		<table class="tblLayout">
		<tr><td>Was a Form 1099-S issued?</td>
			<td><input type="radio" id="F1099SY" name="F1099S" checked /> Yes
				<input type="radio" id="F1099SN" name="F1099S" /> No</td>
			<td></td></tr>
		<tr><td>Was a Form 1099-C issued?</td>
			<td><input type="radio" id="F1099CY" name="F1099C" /> Yes
				<input type="radio" id="F1099CN" name="F1099C" checked /> No</td>
			<td></td></tr>
		<tr id="BankruptRow"><td class="indent">Due to foreclosure or bankruptcy?</td>
			<td><input type="radio" id="BankruptY" name="Bankrupt" /> Yes
				<input type="radio" id="BankruptN" name="Bankrupt" checked /> No</td>
			<td></td></tr>
		<tr id="RefinincingRow"><td>Are you financing the buyer&apos;s purchase of your home?</td>
			<td><input type="radio" id="InstallmentY" name="Installment" /> Yes
				<input type="radio" id="InstallmentN" name="Installment" checked /> No</td>
			<td></td></tr>
		<tr><td><br /><i><u>Sale price</u></i></span></td><td></td><td></td></tr>
		<tr><td id="SalePriceLabel" class="indent">Money received:</td>
			<td>$<input id="SalePrice" class="datain" type="number" /></td><td id="SalePriceComment"></td></tr>
		<tr id="OtherValueRow"><td class="indent">Value of other property/services:</td>
			<td>$<input id="OtherValue" class="datain" type="number" /></td><td id="OtherValueComment"></td></tr>
		<tr id="DebtsRow"><td class="indent">Value of debts assumed by buyer:</td>
			<td>$<input id="Debts" class="datain" type="number" /></td>
			<td>(eg: notes, mortgages)</td></tr>
		<tr id="RETaxesRow"><td class="indent">Real estate taxes paid by buyer on your behalf:</td>
			<td>$<input id="RETaxes" class="datain" type="number" /></td>
			<td></td></tr>
		<tr><td class="indent"></td>
			<td style="border-bottom: 2px solid black;"></td>
			<td></td></tr>
		<tr><td><b>TOTAL SALE PRICE</b></td>
				<td>$<input type="number" class="datain" id="SalePriceTotal" disabled></td>
			<td></td></tr>
		<tr><td colspan="3"><br /><i><u>Expenses</u></i>
			<span id="SaleExpenseComment"></span></td></tr>
		<tr><td class="indent">Realtor commissions:</td>
			<td>$<input id="Realtor" class="datain" type="number" /></td>
			<td></td></tr>
		<tr><td class="indent">Advertising and staging:</td>
			<td>$<input id="Advertising" class="datain" type="number" /></td>
			<td></td></tr>
		<tr><td class="indent">Legal fees:</td>
			<td>$<input id="Legal" class="datain" type="number" /></td>
			<td></td></tr>
		<tr><td class="indent">Buyer&apos;s expenses you agreed to pay:</td>
			<td>$<input id="BuyerExpense" class="datain" type="number" /></td>
			<td>(eg: mortgage points, loan charges)</td></tr>
		<tr><td class="indent">Other expenses:</td>
			<td>$<input id="OtherExpense" class="datain" type="number" /></td>
			<td><input type="text" style="width: 100%"></td></tr>
		<tr><td class="indent"></td>
			<td style="border-bottom: 2px solid black;"></td>
			<td></td></tr>
		<tr><td><b>TOTAL SALE EXPENSES</b></td>
			<td>$<input class="datain" type="number" id="SaleExpensesTotal" disabled></td>
			<td></td></tr>
		</table>
	</div> <!-- SaleDiv -->

	<div id="CostDiv" class="section doPrint" onkeyup="Basis_Calc(event);" onchange="Basis_Calc(event);">
		<span class="tblHeader">Home purchase details:</span>
		<br />&nbsp;
		<span id="CostMFSNotice">
			When filing Married Filing Seperately, only enter your portion of the amounts below.<br />&nbsp;</span>
		<table id="CostTable" class="tblLayout">
		<tr><td id="CostType2"></td>
			<td>$<input id="PurchasePrice" class="datain" type="number" /></td>
			<td id="CostType2Comment"></td></tr>
		<tr><td>Tax assessments:</td>
			<td>$<input id="TaxFee" class="datain" type="number" disabled/></td>
			<td>List these in the Home improvements tab</td></tr>
		<tr><td><br /><i><u>Expenses</u></i> (Increases to basis)</td>
			<td></td><td></td></tr>
		<tr><td class="indent">Legal fees:</td>
			<td>$<input id="LegalFee" class="datain" type="number" /></td>
			<td></td></tr>
		<tr><td class="indent">Survey and recording fees:</td>
			<td>$<input id="SurveyFee" class="datain" type="number" /></td>
			<td></td></tr>
		<tr><td class="indent">Title insurance:</td>
			<td>$<input id="TitleFee" class="datain" type="number" /></td>
			<td></td></tr>
		<tr><td class="indent">Seller fees you agreed to pay:</td>
			<td>$<input id="SellerFee" class="datain" type="number" /></td>
			<td>(eg: real estate taxes prior to sale, title/mortage fees, repair charges, real estate agent commissions)</td></tr>
		<tr><td class="indent">Abstract and recording fees:</td>
			<td>$<input id="AbstractFee" class="datain" type="number" /></td>
			<td></td></tr>
		<tr><td class="indent">Transfer of stamp fees:</td>
			<td>$<input id="StampFee" class="datain" type="number" /></td>
			<td></td></tr>
		<tr><td class="indent">Other fees:</td>
			<td>$<input id="OtherFee" class="datain" type="number" /></td>
			<td>(eg: sales tax on a mobile home or houseboat used as the home)</td></tr>
		<tr><td class="indent"></td>
			<td style="border-bottom: 2px solid black;"></td>
			<td></td></tr>
		<tr><td><b>TOTAL PURCHASE EXPENSES</b></td>
			<td>$<input class="datain" type="number" id="PurchaseExpensesTotal" disabled></td>
			<td></td></tr>
		<tr><td><br /><i><u>Adjustments</u></i> (Decreases to basis)</td>
			<td></td><td></td></tr>
		<tr><td class="indent">Payments received for easement, conservation restriction or right-of-way:</td>
			<td>$<input id="Easements" class="datain" type="number" /></td>
			<td></td></tr>
		<tr><td class="indent">Energy credits or subsidies:</td>
			<td>$<input id="EnergyCredits" type="number" disabled /></td>
			<td>Subtract these credits from the related cost in the home improvements tab</td></tr>
		<tr><td class="indent">Adoption credits claimed or nontaxable payments from an employer-sponsored adoption assistance program:</td>
			<td>$<input id="AdoptionCredits" class="datain" type="number" /></td>
			<td></td></tr>
		<tr><td class="indent">Real estate taxes the seller paid on your behalf:</td>
			<td>$<input id="RETaxesBySeller" class="datain" type="number" /></td>
			<td></td></tr>
		<tr id="PointsBySellerRow">
			<td class="indent">Mortgage points the seller paid on your behalf:</td>
			<td>$<input id="PointsBySeller" class="datain" type="number" /></td>
			<td id="PointsBySellerComment">
			<!--if bought 12/31/1991 - 4/4/1994 and deducted
			or after 4/3/1994 even if not deducted--></td></tr>
		<tr><td class="indent">Sales tax paid on a mobile home or houseboat...</td>
			<td>$<input id="SalesTaxOnHome" class="datain" type="number" /></td>
			<td>...to the extent claimed as a deduction on a federal tax return</td></tr>
		<tr><td class="indent">Other</td>
			<td>$<input id="OtherAdjustments" class="datain" type="number" /></td>
			<td><input type="text" style="width: 100%"></td></tr>
		<tr><td class="indent"></td>
			<td style="border-bottom: 2px solid black;"></td>
			<td></td></tr>
		<tr><td><b>TOTAL PURCHASE ADJUSTMENTS</b></td>
			<td>$<input id="TotalAdjusted" class="datain" type="number" disabled/></td>
			<td></td></tr>
		<tr><td colspan="3"><br /><i><u>Adjusted basis</u></i></td></tr>
		<tr id="DiedBasisRow1"><td id="DiedBasis1">Home improvements before spouse died</td>
			<td>$<input id="PreImproveAmount" class="datain" type="number" disabled /></td>
			<td id="DiedImprovementsComment">(From home improvements tab)</td></tr>
		<tr id="DiedBasisRow3"><td id="DiedBasis3">Adjusted basis after spouse died</td>
			<td>$<input id="DiedBasis" class="datain" type="number" disabled /></td>
			<td id="DiedBasisComment"></td></tr>
		<tr id="DiedBasisRow2"><td id="DiedBasis2">Fair Market Value when spouse died</td>
			<td>$<input id="DiedFMV" class="datain" type="number" /></td>
			<td id="DiedBasisComment"></td></tr>
		<tr id="DiedBasisRow4"><td id="DiedBasis4">HOME COST BASIS NOW</td>
			<td>$<input id="Basis" class="datain" type="number" disabled/></td>
			<td></td></tr>
		<tr><td>Home improvements</td>
			<td>$<input id="ImproveAmount" class="datain" type="number" disabled /></td>
			<td>(From home improvements tab)</td></tr>
		<tr><td class="indent"></td>
			<td style="border-bottom: 2px solid black;"></td>
			<td></td></tr>
		<tr><td><b>ADJUSTED COST BASIS FOR SALE</b></td>
			<td>$<input id="AdjustedCostBasis" class="datain" type="number" disabled/></td>
			<td></td></tr>
		</table>
	</div> <!-- CostDiv -->

	<div id="HomeDiv" class="section doPrint" onkeyup="Basis_Calc(event);" onchange="Basis_Calc(event);">
		<span class="tblHeader">Home improvements:</span>
		<br />&nbsp;
		<br /><b>Examples of improvements you can not include in your basis</b>
		<ul>
			<li>Do not include any costs of repairs or maintenance that are necessary to keep
			your home in good condition but don&apos;t add to its value or prolong its life.
			Examples include painting (interior or exterior), fixing leaks,
			filling holes or cracks, or replacing broken hardware.</li>
			<li>Do not include any costs of any improvements that are no longer part of your home
			(for example, wall-to-wall carpeting that you installed but later replaced).</li>
			<li>Do not include any costs of any improvements with a life expectancy,
			when installed, of less than 1 year.</li>
			<li>Do not enter individual amounts if they are part of a larger renovation project</li>
		</ul>
		<u>Exception</u>: The entire job is considered an improvement if items that would
		otherwise be considered repairs are done as part of an extensive remodeling
		or restoration of your home.
		For example, if you have a casualty and your home is damaged,
		increase your basis by the amount you spend on repairs that restore the property
		to its pre-casualty condition.
		<br /><br /><b>Examples of improvements you can include in your basis</b>
		<ul>
			<li>If the same improvement was made more than once,
				only use the cost for the most recent improvement.</li>
			<li>Subtract any tax credits, subsidies, or grants received from the cost of any improvements.</li>
			<span id="Instruction2"><li>Check the box after the cost amount if the improvement
				was made after
				<span id="InstructionText2"></span>.</li></span>
			<span id="HomeMFSNotice">
				<li>When filing Married Filing Seperately,
					only enter your portion of the amounts below.</li></span>
		</ul>
		<table id="HomeTable" style="margins: auto;">
			<tr>	<th colspan="6"><i><u>Systems</u></i></th></tr>
			<tr>	<td>Air/water filtration systems</td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td>
				<td>Furnace</td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td></tr>
			<tr>	<td>Central air conditioning</td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td>
				<td>Heating system</td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td></tr>
			<tr>	<td>Central humidifier</td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td>
				<td>Lawn sprinkler system</td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td></tr>
			<tr>	<td>Central vacuum</td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td>
				<td>Security system</td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td></tr>
			<tr>	<td>Duct work</td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td>
				<td>Wiring</td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td></tr>
			<tr>	<td><input type="text" placeholder="(Other)" /></td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td>
				<td><input type="text" placeholder="(Other)" /></td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td></tr>
			<tr>	<th colspan="6"><i><u>Additions</u></i></th></tr>
			<tr>	<td>Bedroom</td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td>
				<td>Garage</td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td></tr>
			<tr>	<td>Bathroom</td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td>
				<td>Patio</td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td></tr>
			<tr>	<td>Deck</td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td>
				<td>Porch</td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td></tr>
			<tr>	<td><input type="text" placeholder="(Other)" /></td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td>
				<td><input type="text" placeholder="(Other)" /></td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td></tr>
			<tr>	<th colspan="6"><i><u>Grounds</u></i></th></tr>
			<tr>	<td>Driveway</td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td>
				<td>Retaining wall</td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td></tr>
			<tr>	<td>Fence</td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td>
				<td>Swimming pool</td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td></tr>
			<tr>	<td>Landscaping</td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td>
				<td>Walkway</td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td></tr>
			<tr>	<td><input type="text" placeholder="(Other)" /></td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td>
				<td><input type="text" placeholder="(Other)" /></td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td></tr>
			<tr>	<th colspan="6"><i><u>Pipes and duct work</u></i></th></tr>
			<tr>	<td>Filtration system</td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td>
				<td>Soft water system</td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td></tr>
			<tr>	<td>Plumbing</td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td>
				<td>Water heater</td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td></tr>
			<tr>	<td>Septic system</td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td>
				<td><input type="text" placeholder="(Other)" /></td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td></tr>
			<tr>	<th colspan="6"><i><u>Interior</u></i></th></tr>
			<tr>	<td>Built-in appliances</td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td>
				<td>Kitchen modernizaton</td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td></tr>
			<tr>	<td>Fireplace</td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td>
				<td>Wall-to-wall carpeting</td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td></tr>
			<tr>	<td>Flooring</td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td>
				<td><input type="text" placeholder="(Other)" /></td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td></tr>
			<tr>	<th colspan="6"><i><u>Exterior</u></i></th></tr>
			<tr>	<td>New roof</td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td>
				<td>Satellite dish</td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td></tr>
			<tr>	<td>New siding</td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td>
				<td>Storm windows/doors</td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td></tr>
			<tr>	<td><input type="text" placeholder="(Other)" /></td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td>
				<td><input type="text" placeholder="(Other)" /></td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td></tr>
			<tr>	<th colspan="6"><i><u>Insulation</u></i></th></tr>
			<tr>	<td>Attic</td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td>
				<td>Walls</td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td></tr>
			<tr>	<td>Floors</td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td>
				<td><input type="text" placeholder="(Other)" /></td>
				<td>$<input class="datain HomeImprovement" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td></tr>
			<tr>	<th colspan="6"><i><u>Tax Assessments</u></i></th></tr>
			<tr>	<td>Sidewalks</td>
				<td>$<input class="datain HomeImprovement Assessment" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td>
				<td>Streets</td>
				<td>$<input class="datain HomeImprovement Assessment" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td></tr>
			<tr>	<td>HOA/Condominium assessments</td>
				<td>$<input class="datain HomeImprovement Assessment" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td>
				<td><input type="text" placeholder="(Other)" /></td>
				<td>$<input class="datain HomeImprovement Assessment" type="number" /></td>
				<td><input type="checkbox" class="ImprovementAfterDoD" /></td></tr>
			<tr>	<th colspan="6"><i><u>Remodeling projects</u></i></th></tr>
			<tr>	<td colspan="6"><i>For repairs done as part of larger project</i>
				 &mdash; See the exception note above.</td></tr>
		</table>
		<br /><br />
		<div id="HITotal">
			<span id="ResultsBoth">
				Home improvements before
				<span id="SPImprovementsPrior"></span> =
				$<span id="HomeImprovementPrior"></span>
				<br />Home improvements after
				<span id="SPImprovementsAfter"></span>=
				$<span id="HomeImprovementAfter"></span>
			</span>	
			<span id="Results">
				Home improvements total =
				$<span id="HomeImprovementTotal"></span>
			</span>	
		</div>
	
	</div> <!-- HomeDiv -->
</div> <!-- InputDiv -->

<div id="MessageDiv" class="section noPrint" style="margin-top:0" onchange="Basis_Calc(event);">
	<span id="QualificationMessage"></span>
	<span id="ErrorMessage"></span>
	<span id="ExclusionMessage"></span>
	<span id="UseExclusionOption">Do you wish to use the exclusion?
		<input type="radio" id="UseExclusionY" name="UseExclusion" checked /> Yes
		<input type="radio" id="UseExclusionN" name="UseExclusion" /> No&nbsp;
		<span id="ExclusionInfo" class="help"
			onmouseover="ExclusionInfoText.style.display='block'; "
			onmouseout="ExclusionInfoText.style.display='none';">&nbsp;?&nbsp;
			</span>
		<span id="ExclusionInfoText" class="helpText"
			onmouseover="ExclusionInfoText.style.display='block'; "
			onmouseout="ExclusionInfoText.style.display='none';">
			If a sale of a different main home is expected within 2 years,
		it may be advantageous to wait for that sale, especially if
		the full exclusion is not available for this sale.
		</span>
	</span>

</div> <!-- MessageDiv -->

<div id="TSInputDiv" class="doPrint section" onchange="Basis_Calc(event);">
	<span class="tblHeader">TaxSlayer input:</span>
	<span id="TSChoices">
		<input id="UseSchedD" name="EnterAs" type="radio" checked /> Enter directly as Capital Gains
		<input id="UseWorksheet" name="EnterAs" type="radio" />
		<span id="UWOptionText"> Enter on Sale of Home Worksheet</span>
	</span>
	<div id="TSNoNeedToEnter">
		<br />&nbsp;
		Since a Form 1099-S was not issued and the use of the exclusion produces no gain,
		this main home sale does not need to be reported to the IRS.
		If you do wish to report it, check this box &#x261B; <input id="NoNeedButShow" type="checkbox" />.
	</div>
	<div id="TSWorksheet" class="doprint">
		<br />&nbsp;
		<table id="TSTable">
		<tr><th></th><th></th><th></th><th></th></tr>
		<tr><th colspan="4">Sale of Main Home Worksheet</th></tr>
		<tr><td colspan="4"><b>Basic Information about Your Home</b></td></tr>
		<tr><td></td><td colspan="3"><b>Basic info about the Sale</b></td></tr>
		<tr><td colspan="2"></td>
			<td>Date of purchase</td>
		<td id="TSPurchaseDate"></td></tr>
		<tr><td colspan="2"></td>
			<td>Purchase price</td>
			<td id="TSPurchasePrice"></td></tr>
		<tr><td colspan="2"></td>
			<td>Date of sale</td>
			<td id="TSSaleDate"></td></tr>
		<tr><td colspan="2"></td>
			<td>Sale price</td>
			<td id="TSSalePriceTotal"></td></tr>
		<tr><td></td><td colspan="3"> <b>Info about your home</b></td></tr>
		<tr><td colspan="2"></td>
			<td>How many days in the last 5 years was the home your main home?</td>
			<td id="TSTPTwoYears"></td></tr>
		<tr><td colspan="2"></td>
			<td>How many days in the last 5 years did you own your home?</td>
			<td id="TSTPOwner"></td></tr>
		<tr id="TSTPLookbackDaysRow"><td colspan="2"></td>
			<td>How many days since your previous exclusion?</td>
			<td id="TSTPLookbackDays">(blank)</td></tr>
		<tr id="TSSPTwoYearsRow"><td colspan="2"></td>
			<td>How many days in the last 5 years was the home your spouse&apos;s main home</td>
			<td id="TSSPTwoYears"></td></tr>
		<tr id="TSSPOwnerRow"><td colspan="2"></td>
			<td>How many days in the last 5 years did your spouse own your home?</td>
			<td id="TSSPOwner"></td></tr>
		<tr id="TSSPLookbackDaysRow"><td colspan="2"></td>
			<td>How many days since your previous exclusion?</td>
			<td id="TSSPLookbackDays">(blank)</td></tr>
		<tr id="TSTPDaysOwnedRow"><td colspan="2"></td>
			<td>Number of days taxpayer owned the property</td>
			<td id="TSTPDaysOwned"</td></tr>
		<tr><td colspan="2"></td>
			<td>Check here if you recieved the first-time Homebuyers Credit... (complete if needed)</td>
			<td id="TSHBCredit"></td></tr>
		<tr class="FTHB"><td></td><td colspan="3"><b>First-time homebuyer credit - Sale of Home section</b></td></tr>
		<tr class="FTHB"><td colspan="2"></td>
			<td><i>(Answer first-time homebuyer questions as needed)</i></td>
			<td></td></tr>
		<tr class="FTHB"><td colspan="2"></td>
			<td>Selling price of home, insurance proceeds, ...</td>
			<td id="TSHCSalePriceTotal"></td></tr>
		<tr class="FTHB"><td colspan="2"></td>
			<td>Selling expenses (including commissions, advertising and legal fees, ...></td>
			<td id="TSHCSaleExpensesTotal"></td></tr>
		<tr class="FTHB"><td colspan="2"></td>
			<td>Adjusted basis of home sold</td>
			<td id="TSHCAdjustedBasis"></td></tr>
		<tr><td colspan="2"></td>
			<td>Check here if you qualify for the Maximum Exclusion or the Reduced Maximum Exclusion (TP)</td>
			<td id="TSTPQualifies"></td></tr>
		<tr id="TSSPQualifiesRow"><td colspan="2"></td>
			<td>Check here if you qualify for the Maximum Exclusion or the Reduced Maximum Exclusion (SP)</td>
			<td id="TSSPQualifies"></td></tr>
		<tr><td colspan="4"><b>Adjustments to the Sale</td></tr>
		<tr><td></td><td colspan="3"><b>Fees you may have paid when you bought your home</b></td></tr>
		<tr><td colspan="2"></td>
			<td>Legal fees</td>
			<td id="TSLegalFee"></td></tr>
		<tr><td colspan="2"></td>
			<td>Surveys</td>
			<td id="TSSurveyFee"></td></tr>
		<tr><td colspan="2"></td>
			<td>Title Insurance</td>
			<td id="TSTitleFee"></td></tr>
		<tr><td colspan="2"></td>
			<td>Fees that the seller owed that you agreed to pay</td>
			<td id="TSSellerFee"></td></tr>
		<tr><td colspan="2"></td>
			<td>Other fees</td>
			<td id="TSOtherFee"></td></tr>
		<tr><td colspan="2"></td>
			<td>Abstract and recording fees</td>
			<td id="TSAbstractFee"></td></tr>
		<tr><td colspan="2"></td>
			<td>Transfer of stamp fees</td>
			<td id="TSStampFee"></td></tr>
		<tr><td></td><td colspan="3"><b>General adjustments</b></td></tr>
		<tr><td colspan="2"></td>
			<td>Selling expenses</td>
			<td id="TSSaleExpensesTotal"></td></tr>
		<tr><td colspan="2"></td>
			<td>Cost of additions and improvements that you made to your home</td>
			<td id="TSImproveAmount"></td></tr>
		<tr><td colspan="2"></td>
			<td>Tax assessments that you paid for sidewalks, streets and other local improvements</td>
			<td id="TSTaxFee"></td></tr>
		<tr><td colspan="2"></td>
			<td>Other increases to your basis</td>
			<td id="TSIncreases"></td></tr>
		<tr><td colspan="2"></td>
			<td>Decreases to your basis</td>
			<td id="TSTotalAdjusted"></td></tr>
		<tr id="TSSPDiedExclusionRow"><td colspan="2"></td>
			<td>Does return qualify for $500,000 max exclusion?</td>
			<td id="TSDiedExclusion"></td></tr>
		</table>
		</div>
	<div id="SchedD" class="doprint">
		<br />&nbsp;
		<table class="tblLayout">
		<tr><th colspan="3">Capital Gains and Loss Items</th></tr>
		<tr><td>Description of Property</td>
			<td id="HomeType">Main home</td>
			<td></td></tr>
		<tr><td>Date Acquired</td>
			<td id="DateAcquired"></td>
			<td></td></tr>
		<tr><td>Date Sold</td>
			<td id="DateSold"></td>
			<td></td></tr>
		<tr><td>Sales Price</td>
			<td id="SalesPrice"></td>
			<td></td></tr>
		<tr><td>Cost basis type</td>
			<td colspan="2" id="CostBasisType">Did not receive Form 1099-B</td></tr>
		<tr><td>Cost</td>
			<td id="Cost"></td>
			<td></td></tr>
		<tr><td>Adjustments</td>
			<td id="Adjustments"></td">
			<td id="AdjustmentDetail"></td></tr>
		<tr><td>Adjustment explanation</td>
			<td id="AdjustmentReason">H</td>
			<td></td></tr>
		</table>
		<hr />
		<table class="tblLayout">
		<tr class="italic">
			<td>Gain/Loss</td>
			<td id="GainOrLoss"></td>
			<td></td></tr>
		</table>
	</div>
</div>

<div class="noPrint section">
	Please send corrections and suggestions to
	<a href="mailto:tools@cotaxaide.org">tools@cotaxaide.org</a>
  	<span id="printbutton2" style="float: right;">
		<button onclick="window.print()">Print a taxpayer copy</button>
	</span>
</div>

<script> // putting these here vs in the Initialize function makes them global
	var InfoDivElement = document.getElementById("InfoDiv");
	var InfoDivTabElement = document.getElementById("InfoDivTab");
	var SaleDivElement = document.getElementById("SaleDiv");
	var SaleDivTabElement = document.getElementById("SaleDivTab");
	var CostDivElement = document.getElementById("CostDiv");
	var CostDivTabElement = document.getElementById("CostDivTab");
	var HomeDivElement = document.getElementById("HomeDiv");
	var HomeDivTabElement = document.getElementById("HomeDivTab");
	var HomeTableElement = document.getElementById("HomeTable");
	var HomeImprovementList = document.getElementsByClassName("HomeImprovement");
	var HomeImprovementDoD = document.getElementsByClassName("ImprovementAfterDoD");
	var Assessments = document.getElementsByClassName("Assessment");
	var FTHBList = document.getElementsByClassName("FTHB");
</script>
</body>
